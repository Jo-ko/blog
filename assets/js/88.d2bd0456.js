(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{526:function(t,i,a){"use strict";a.r(i);var r=a(3),e=Object(r.a)({},(function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"基本架构图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本架构图"}},[t._v("#")]),t._v(" 基本架构图")]),t._v(" "),a("img",{attrs:{src:t.$withBase("/native/miniProgram-整体架构.png"),alt:"miniProgram-整体架构"}}),t._v(" "),a("h2",{attrs:{id:"同层渲染"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#同层渲染"}},[t._v("#")]),t._v(" 同层渲染")]),t._v(" "),a("blockquote",[a("p",[t._v("原生组件和webview视图不在一个画布上,并且原生组件的层级高于webview视图组件,导致在视图渲染的一些层级问题")])]),t._v(" "),a("h3",{attrs:{id:"原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[t._v("#")]),t._v(" 原理")]),t._v(" "),a("h4",{attrs:{id:"ios端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ios端"}},[t._v("#")]),t._v(" ios端")]),t._v(" "),a("blockquote",[a("p",[t._v("ios端的渲染层内核是Webkit,基于WKChildScrollView这个原生组件,当一个原生组件挂载时,会将其转移到预先建好的WKChildScrollView容器中")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("步骤")]),t._v(" "),a("ol",[a("li",[t._v("创建一个DOM,设置属性overflow: scroll且-webkit-overflow-scrolling: touch")]),t._v(" "),a("li",[t._v("查找该DOM节点对应的WKChildScrollView")]),t._v(" "),a("li",[t._v("将原生组件挂载到该容器下作为子节点\n"),a("img",{attrs:{src:t.$withBase("/native/miniProgram-同层渲染-ios.png"),alt:"miniProgram-同层渲染-ios"}})])])]),t._v(" "),a("h4",{attrs:{id:"android端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#android端"}},[t._v("#")]),t._v(" Android端")]),t._v(" "),a("blockquote",[a("p",[t._v("安卓端的渲染成内核是Blink, 利用WebPlugin机制和embed标签")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("步骤")]),t._v(" "),a("ol",[a("li",[t._v("webview创建一个embed标签,并制定type类型")]),t._v(" "),a("li",[t._v("Blink内核会创建一个WebPlugin实例,并且生成一个RenderLayer")]),t._v(" "),a("li",[t._v("客户端创建一个原生组件实例")]),t._v(" "),a("li",[t._v("客户端将该实例绘制到RenderLayer所绑定的surfaceTexture")]),t._v(" "),a("li",[t._v("通知Blink内核渲染RenderLayer\n"),a("img",{attrs:{src:t.$withBase("/native/miniProgram-同层渲染-andorid.png"),alt:"miniProgram-同层渲染-andorid"}})])])]),t._v(" "),a("h2",{attrs:{id:"优化方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化方案"}},[t._v("#")]),t._v(" 优化方案")]),t._v(" "),a("ol",[a("li",[t._v("将一些静态的展示页面,比如说明页,隐私政策或者一些临时性很强的,比如活动页,放到webview中")])])])}),[],!1,null,null,null);i.default=e.exports}}]);